# s3-lambda-uploader - AWS Lambda and S3 Upload Tool

## WHAT:

This project provides simple example code to allow web page form file uploads directly to AWS S3 storage, using an AWS Lambda serverless function to provide unique pre-signed S3 URLs for uploading while maintaining security on your S3 bucket.

This works with any type of file and is easily configured through environment variables.

## WHY:

Any time you want to allow end users of your website to be able to upload files and have those files end up in AWS S3 storage, this is an easy and scalable solution.

Since the pre-signed URLs are generated by a Lambda function, and the uploads got directly to S3, your own website or web application is never the bottleneck for uploading files and doesn't have to handle long running upload processes. In fact, you can use this with a completely static website!

## HOW:

There are three parts to this: the HTML file upload form, the Javascript that manages the form upload on the web browser, and the Lambda function (which in this case is a Node 12.x compatible Javascript function).

The HTML form is very basic and you can easily use your own form instead, you may just need to adjust some of the jQuery selectors used in the form handling Javascript.

The Javascript uses jQuery and at a high level, intercepts the file upload form submission, calls the Lambda function (through an AWS API gateway URL) to get the pre-signed S3 upload URL, and then PUTs the file to S3 directly from the user's browser.

I have also implemented a basic progress bar and success or error messages into the form HTML and the Javascript.

The Lambda function looks for a filename and filetype in the request, which are set from the Javascript, and then uses the AWS S3 API to generate a pre-signed upload URL which is returned to the browser along with a new filename in a simple JSON response structure. In order to avoid file name conflict, such as 10 people all uploading "resume.doc", the function prefixes the provided filename with a random six characters and a configured filename separator string. So "resume.doc" might be stored in S3 as "gW8v1G----resume.doc". You may extend the client side Javascript to pass this, along with an upload complete API call to your web application for instance, to hand things off for processing. Or you can use S3 events to trigger processing directly.

For detailed implementation instructions please refer to INSTRUCTIONS.md
